"0","# Split the dataset and scale the coefficients."
"0","scaled <- mtcars %>%"
"0","  split(.$gear) %>%"
"0","  map(~ as.data.frame(scale(.x)))"
"0","map(scaled, head) # see 1st few rows for each subset."
"1","$`3`
"
"1","                 "
"1","         mpg"
"1","        cyl"
"1","       disp"
"1","
Hornet 4 Drive   "
"1","  1.56996818"
"1"," -1.2353648"
"1"," -0.7200636"
"1","
Hornet Sportabout"
"1","  0.76916577"
"1","  0.4492236"
"1","  0.3552876"
"1","
Valiant          "
"1","  0.59120968"
"1"," -1.2353648"
"1"," -1.0679713"
"1","
Duster 360       "
"1"," -0.53584556"
"1","  0.4492236"
"1","  0.3552876"
"1","
Merc 450SE       "
"1","  0.08700076"
"1","  0.4492236"
"1"," -0.5324043"
"1","
Merc 450SL       "
"1","  0.35393489"
"1","  0.4492236"
"1"," -0.5324043"
"1","
"
"1","                 "
"1","          hp"
"1","        drat"
"1","         wt"
"1","
Hornet 4 Drive   "
"1"," -1.38675494"
"1"," -0.19244960"
"1"," -0.8134523"
"1","
Hornet Sportabout"
"1"," -0.02376495"
"1","  0.06333784"
"1"," -0.5433420"
"1","
Valiant          "
"1"," -1.49160032"
"1"," -1.36176363"
"1"," -0.5193322"
"1","
Duster 360       "
"1","  1.44407041"
"1","  0.28258422"
"1"," -0.3872782"
"1","
Merc 450SE       "
"1","  0.08108043"
"1"," -0.22899066"
"1","  0.2129670"
"1","
Merc 450SL       "
"1","  0.08108043"
"1"," -0.22899066"
"1"," -0.1951998"
"1","
"
"1","                 "
"1","        qsec"
"1","         vs"
"1","  am"
"1"," gear"
"1","
Hornet 4 Drive   "
"1","  1.29489500"
"1","  1.9321836"
"1"," NaN"
"1","  NaN"
"1","
Hornet Sportabout"
"1"," -0.49780861"
"1"," -0.4830459"
"1"," NaN"
"1","  NaN"
"1","
Valiant          "
"1","  1.87270856"
"1","  1.9321836"
"1"," NaN"
"1","  NaN"
"1","
Duster 360       "
"1"," -1.37193681"
"1"," -0.4830459"
"1"," NaN"
"1","  NaN"
"1","
Merc 450SE       "
"1"," -0.21630969"
"1"," -0.4830459"
"1"," NaN"
"1","  NaN"
"1","
Merc 450SL       "
"1"," -0.06815237"
"1"," -0.4830459"
"1"," NaN"
"1","  NaN"
"1","
"
"1","                 "
"1","       carb"
"1","
Hornet 4 Drive   "
"1"," -1.4182716"
"1","
Hornet Sportabout"
"1"," -0.5673086"
"1","
Valiant          "
"1"," -1.4182716"
"1","
Duster 360       "
"1","  1.1346173"
"1","
Merc 450SE       "
"1","  0.2836543"
"1","
Merc 450SL       "
"1","  0.2836543"
"1","
"
"1","
"
"1","$`4`
"
"1","             "
"1","         mpg"
"1","        cyl"
"1","       disp"
"1","
Mazda RX4    "
"1"," -0.66960225"
"1","  1.3540064"
"1","  0.9505021"
"1","
Mazda RX4 Wag"
"1"," -0.66960225"
"1","  1.3540064"
"1","  0.9505021"
"1","
Datsun 710   "
"1"," -0.32848412"
"1"," -0.6770032"
"1"," -0.3859407"
"1","
Merc 240D    "
"1"," -0.02526801"
"1"," -0.6770032"
"1","  0.6086811"
"1","
Merc 230     "
"1"," -0.32848412"
"1"," -0.6770032"
"1","  0.4570463"
"1","
Merc 280     "
"1"," -1.01072038"
"1","  1.3540064"
"1","  1.1458283"
"1","
"
"1","             "
"1","         hp"
"1","       drat"
"1","           wt"
"1","
Mazda RX4    "
"1","  0.7917156"
"1"," -0.4588273"
"1","  0.005268687"
"1","
Mazda RX4 Wag"
"1","  0.7917156"
"1"," -0.4588273"
"1","  0.408323233"
"1","
Datsun 710   "
"1","  0.1351710"
"1"," -0.6188834"
"1"," -0.468913132"
"1","
Merc 240D    "
"1"," -1.0620575"
"1"," -1.1310627"
"1","  0.906214143"
"1","
Merc 230     "
"1","  0.2124115"
"1"," -0.3948049"
"1","  0.842989901"
"1","
Merc 280     "
"1","  1.2937791"
"1"," -0.3948049"
"1","  1.301365659"
"1","
"
"1","             "
"1","       qsec"
"1","         vs"
"1","         am"
"1"," gear"
"1","
Mazda RX4    "
"1"," -1.5521599"
"1"," -2.1408721"
"1","  0.6770032"
"1","  NaN"
"1","
Mazda RX4 Wag"
"1"," -1.2051700"
"1"," -2.1408721"
"1","  0.6770032"
"1","  NaN"
"1","
Datsun 710   "
"1"," -0.2199668"
"1","  0.4281744"
"1","  0.6770032"
"1","  NaN"
"1","
Merc 240D    "
"1","  0.6413116"
"1","  0.4281744"
"1"," -1.3540064"
"1","  NaN"
"1","
Merc 230     "
"1","  2.4382232"
"1","  0.4281744"
"1"," -1.3540064"
"1","  NaN"
"1","
Merc 280     "
"1"," -0.4120504"
"1","  0.4281744"
"1"," -1.3540064"
"1","  NaN"
"1","
"
"1","             "
"1","       carb"
"1","
Mazda RX4    "
"1","  1.2794158"
"1","
Mazda RX4 Wag"
"1","  1.2794158"
"1","
Datsun 710   "
"1"," -1.0235326"
"1","
Merc 240D    "
"1"," -0.2558832"
"1","
Merc 230     "
"1"," -0.2558832"
"1","
Merc 280     "
"1","  1.2794158"
"1","
"
"1","
"
"1","$`5`
"
"1","              "
"1","        mpg"
"1"," cyl"
"1","       disp"
"1","         hp"
"1","
Porsche 914-2 "
"1","  0.6938001"
"1","  -1"
"1"," -0.7115728"
"1"," -1.0171748"
"1","
Lotus Europa  "
"1","  1.3545620"
"1","  -1"
"1"," -0.9297723"
"1"," -0.8032375"
"1","
Ford Pantera L"
"1"," -0.8379663"
"1","   1"
"1","  1.2859917"
"1","  0.6651507"
"1","
Ferrari Dino  "
"1"," -0.2522909"
"1","   0"
"1"," -0.4977027"
"1"," -0.2003231"
"1","
Maserati Bora "
"1"," -0.9581049"
"1","   1"
"1","  0.8530562"
"1","  1.3555848"
"1","
"
"1","              "
"1","       drat"
"1","         wt"
"1","       qsec"
"1","
Porsche 914-2 "
"1","  1.3195547"
"1"," -0.6015200"
"1","  0.9376493"
"1","
Lotus Europa  "
"1"," -0.3748151"
"1"," -1.3671575"
"1","  1.1145643"
"1","
Ford Pantera L"
"1","  0.7804370"
"1","  0.6562258"
"1"," -1.0084153"
"1","
Ferrari Dino  "
"1"," -0.7598992"
"1","  0.1677809"
"1"," -0.1238405"
"1","
Maserati Bora "
"1"," -0.9652774"
"1","  1.1446708"
"1"," -0.9199578"
"1","
"
"1","              "
"1","         vs"
"1","  am"
"1"," gear"
"1","      carb"
"1","
Porsche 914-2 "
"1"," -0.4472136"
"1"," NaN"
"1","  NaN"
"1"," -0.920358"
"1","
Lotus Europa  "
"1","  1.7888544"
"1"," NaN"
"1","  NaN"
"1"," -0.920358"
"1","
Ford Pantera L"
"1"," -0.4472136"
"1"," NaN"
"1","  NaN"
"1"," -0.153393"
"1","
Ferrari Dino  "
"1"," -0.4472136"
"1"," NaN"
"1","  NaN"
"1","  0.613572"
"1","
Maserati Bora "
"1"," -0.4472136"
"1"," NaN"
"1","  NaN"
"1","  1.380537"
"1","
"
"1","
"
"0","# Obtain the coefficients"
"0","coefs <- scaled %>%"
"0","  map(~ lm(mpg ~ wt + hp + disp, .x)) %>%"
"0","  map(~ coef(summary(.x))) "
"0","coefs"
"1","$`3`
"
"1","           "
"1","      Estimate"
"1"," Std. Error"
"1","       t value"
"1","
(Intercept)"
"1","  2.525720e-16"
"1","  0.1587713"
"1","  1.590791e-15"
"1","
wt         "
"1"," -5.713684e-01"
"1","  0.3115032"
"1"," -1.834230e+00"
"1","
hp         "
"1"," -4.306828e-01"
"1","  0.2493851"
"1"," -1.726979e+00"
"1","
disp       "
"1","  8.408336e-02"
"1","  0.3589857"
"1","  2.342248e-01"
"1","
"
"1","           "
"1","  Pr(>|t|)"
"1","
(Intercept)"
"1"," 1.0000000"
"1","
wt         "
"1"," 0.0937885"
"1","
hp         "
"1"," 0.1121072"
"1","
disp       "
"1"," 0.8191129"
"1","
"
"1","
"
"1","$`4`
"
"1","           "
"1","      Estimate"
"1"," Std. Error"
"1","       t value"
"1","
(Intercept)"
"1","  2.970767e-16"
"1","  0.1187895"
"1","  2.500866e-15"
"1","
wt         "
"1"," -2.034460e-02"
"1","  0.3011412"
"1"," -6.755835e-02"
"1","
hp         "
"1"," -4.342680e-01"
"1","  0.2117560"
"1"," -2.050795e+00"
"1","
disp       "
"1"," -5.307267e-01"
"1","  0.3487121"
"1"," -1.521962e+00"
"1","
"
"1","           "
"1","   Pr(>|t|)"
"1","
(Intercept)"
"1"," 1.00000000"
"1","
wt         "
"1"," 0.94779518"
"1","
hp         "
"1"," 0.07441627"
"1","
disp       "
"1"," 0.16651485"
"1","
"
"1","
"
"1","$`5`
"
"1","           "
"1","      Estimate"
"1"," Std. Error"
"1","       t value"
"1","
(Intercept)"
"1","  3.863715e-17"
"1","  0.1057642"
"1","  3.653139e-16"
"1","
wt         "
"1"," -9.831730e-01"
"1","  0.3021465"
"1"," -3.253961e+00"
"1","
hp         "
"1","  1.675696e-01"
"1","  0.3475996"
"1","  4.820766e-01"
"1","
disp       "
"1"," -1.861314e-01"
"1","  0.2721580"
"1"," -6.839094e-01"
"1","
"
"1","           "
"1","  Pr(>|t|)"
"1","
(Intercept)"
"1"," 1.0000000"
"1","
wt         "
"1"," 0.1898125"
"1","
hp         "
"1"," 0.7140264"
"1","
disp       "
"1"," 0.6181268"
"1","
"
"1","
"
"0","# Create columns for the variables and "
"0","# indicators for the subsets."
"0","coefs2 <- coefs %>%"
"0","  map(as.data.frame) %>%"
"0","  map(~ mutate(.x, Term = rownames(.x))) %>%"
"0","  map2_df(3:5, ~ mutate(.x, Gear = .y)) %>%"
"0","  select(Gear, Term, everything())"
"0","coefs2"
"1","  "
"1"," Gear"
"1","        Term"
"1","      Estimate"
"1"," Std. Error"
"1","
1 "
"1","    3"
"1"," (Intercept)"
"1","  2.525720e-16"
"1","  0.1587713"
"1","
2 "
"1","    3"
"1","          wt"
"1"," -5.713684e-01"
"1","  0.3115032"
"1","
3 "
"1","    3"
"1","          hp"
"1"," -4.306828e-01"
"1","  0.2493851"
"1","
4 "
"1","    3"
"1","        disp"
"1","  8.408336e-02"
"1","  0.3589857"
"1","
5 "
"1","    4"
"1"," (Intercept)"
"1","  2.970767e-16"
"1","  0.1187895"
"1","
6 "
"1","    4"
"1","          wt"
"1"," -2.034460e-02"
"1","  0.3011412"
"1","
7 "
"1","    4"
"1","          hp"
"1"," -4.342680e-01"
"1","  0.2117560"
"1","
8 "
"1","    4"
"1","        disp"
"1"," -5.307267e-01"
"1","  0.3487121"
"1","
9 "
"1","    5"
"1"," (Intercept)"
"1","  3.863715e-17"
"1","  0.1057642"
"1","
10"
"1","    5"
"1","          wt"
"1"," -9.831730e-01"
"1","  0.3021465"
"1","
11"
"1","    5"
"1","          hp"
"1","  1.675696e-01"
"1","  0.3475996"
"1","
12"
"1","    5"
"1","        disp"
"1"," -1.861314e-01"
"1","  0.2721580"
"1","
"
"1","  "
"1","       t value"
"1","   Pr(>|t|)"
"1","
1 "
"1","  1.590791e-15"
"1"," 1.00000000"
"1","
2 "
"1"," -1.834230e+00"
"1"," 0.09378850"
"1","
3 "
"1"," -1.726979e+00"
"1"," 0.11210723"
"1","
4 "
"1","  2.342248e-01"
"1"," 0.81911285"
"1","
5 "
"1","  2.500866e-15"
"1"," 1.00000000"
"1","
6 "
"1"," -6.755835e-02"
"1"," 0.94779518"
"1","
7 "
"1"," -2.050795e+00"
"1"," 0.07441627"
"1","
8 "
"1"," -1.521962e+00"
"1"," 0.16651485"
"1","
9 "
"1","  3.653139e-16"
"1"," 1.00000000"
"1","
10"
"1"," -3.253961e+00"
"1"," 0.18981249"
"1","
11"
"1","  4.820766e-01"
"1"," 0.71402636"
"1","
12"
"1"," -6.839094e-01"
"1"," 0.61812678"
"1","
"
"0","# Plot the scaled coefficients."
"0","## Set the canvas."
"0","ggplot(coefs2) + "
"0","## Set the aesthetics.  "
"0","  aes(y = Estimate,"
"0","      x = Term,"
"0","      fill = factor(Gear)) + "
"0","## Create the bars.  "
"0","  geom_col(position = 'dodge', # Set bars beside each other."
"0","           alpha = 0.8) + # Set transparency."
"0","## Color the bars."
"0","   scale_fill_brewer(palette = 'Blues') +"
"0","## Relabel y-axis and other labels.  "
"0","  labs(y = 'Coefficient (Scaled)',"
"0","       fill = 'Number of Gears',"
"0","       title = 'Scaled Coefficient Comparisons by Number of Gears') + "
"0","## Customize the background.  "
"0","  theme_light() + "
"0","  theme(panel.grid.minor = element_blank(),"
"0","        panel.grid.major.x = element_blank())"
